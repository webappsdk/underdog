var U={un:function(e){if("undefined"==typeof e||null==e)return!0},escapeSpecialCharsRegExp:function(e){return e.replace(/([.*+?^=!:${}()|\[\]\/\\])/g,"\\$1")},type:function(e){return Array.isArray(e)?"array":"string"==typeof e?"string":null!=e&&"object"==typeof e?"object":"other"},loadjs:function(e,g){if(!U.un(e)){var f=document.createElement("script"),h=document.body;if(g){var k=!1;f.onload=f.onreadystatechange=function(){k||this.readyState&&"loaded"!==this.readyState&&"complete"!==this.readyState||
(k=!0,g(),f.onload=f.onreadystatechange=null,h&&f.parentNode&&h.removeChild(f))}}f.setAttribute("type","text/javascript");f.setAttribute("src",e);h.appendChild(f)}}};Promise.prototype["finally"]=function(e){return"function"!==typeof e?this.then():this.then(e,e)};
var CH=function(){var e={},g={};return{init:function(f,h){"session"==f?e=window.sessionStorage:"local"==f&&(e=window.localStorage);e["CH.storageType"]=f;if("session"==f||"local"==f)for(var k in e)try{g[k]=JSON.parse(e[k])}catch(l){}h&&h()},cache:function(f,h){if(null==h)return U.un(g[f])?e[f]:g[f];var k=U.type(h);"object"==k||"array"==k?(g[f]=h,new Promise(function(g,k){e[f]=JSON.stringify(h);g()})):e[f]=h},clear:function(f){null==f?(e==window.sessionStorage||e==window.localStorage?e.clear():e={},
g={}):(delete e[f],delete g[f])}}}(),PH=function(){function e(a){var c=a.split(".");if(1<c.length){a={id:a,"package":c[0]};for(var b="",d=1;d<c.length;d++)b+=c[d],d<c.length-1&&(b+="/");a.pluginPath=b;return a}return null}function g(a,c,b,d){if(null==c||"eager"!=c&&"lazy"!=c)c="lazy";var e=CH.cache("PH.loader");if(e[a]){var q=Object.keys(e[a]);if(0<q.length){var r=function(a,b){for(var c=q.length;c--;){var d=q[c],e=h[d];(e.load&&e.load==a||"undefined"==typeof e.load&&"lazy"==a)&&"undefined"==typeof m[d]&&
f(d,null,!0)}},g=function(a,c,b){null==b&&(b=0);if(q.length>b){var d=q[b],e=h[d];(e.load&&e.load==a||"undefined"==typeof e.load&&"lazy"==a)&&"undefined"==typeof m[d]?f(d,function(){b++;g(a,c,b)}):(b++,g(a,c,b))}else c&&c()},h=e[a];d?r(c,b):g(c,b)}}else b&&b()}function f(a,c,b){var d=e(a);null!=d&&(b?(h(d,function(b){PH.fire("plugin-configuration-load-after",{pluginId:a,configuration:b})}),b=CH.cache("PH.roots")[a]+d["package"]+"/client/"+d.pluginPath+".js",U.loadjs(b,c)):h(d,function(b){PH.fire("plugin-configuration-load-after",
{pluginId:a,configuration:b},function(){var b=CH.cache("PH.roots")[a]+d["package"]+"/client/"+d.pluginPath+".js";U.loadjs(b,c)})}))}function h(a,c){var b=CH.cache("PH.configurations"),d=a.id;if(b[d])c(b[d]);else{var e=CH.cache("PH.roots")[d]+"/"+a["package"]+"/configuration.json";CRUD.loadJSON(e,function(a){b[d]=a;CH.cache("PH.configurations",b);c(a)})}}function k(a,c){var b=c["extends"];if("array"==U.type(b))for(var d=a["extends"],e=b.length;e--;){var f=b[e];-1==d.indexOf(f)&&d.push(f)}for(var r in c)"undefined"==
typeof a[r]&&(a[r]=c[r])}function l(a){if("array"==U.type(a["extends"])){for(var c=a["extends"],b=c.length;b--;){var d=c[b];n[d]?n[d].push(a.id):n[d]=[a.id];d=PH.getPluginById(d);null!=d&&(k(a,d),d.removeEvents())}return!0}return!1}function t(a){var c=!1;if(n[a.id]){for(var b=n[a.id],d=b.length;d--;){var e=PH.getPluginById(b[d]);null!=e&&(k(e,a),c=!0)}c&&a.removeEvents()}return c}function u(a){var c=CH.cache("PH.roots");a._root=c[a.id]?c[a.id]:"./";for(var b in v)"undefined"==typeof a[b]&&(a[b]=v[b])}
function w(a,c,b,d){var e={plugin:a,params:c,eventName:b};PH.fire(a.id+"-before",e,function(c){(new Promise(function(d,f){PH.fire(a.id+"-in-process",e);var g=CH.cache("PH.configurations")[a.id];U.un(g)&&(g={});try{var h=a.run(c,g,b);d(h)}catch(k){if(console.error((a.id?"["+a.id+"]":"")+" plugin execution failure : ",k),"function"==typeof a.onFailure)try{var l=a.onFailure("plugin_execution_failure",c,b);U.un(l)?f("plugin_execution_failure"):f(l)}catch(m){f("plugin_execution_failure")}else f("plugin_execution_failure")}})).then(function(a){d&&
d(a)},function(b){a.remove();b={success:!1,message:b,data:e};d&&d(b);PH.fire("plugin-execution-failure",b)})["finally"](function(){PH.fire(a.id+"-after",e)})})}function x(a,c,b,d){null!=a&&"function"==typeof a.onMessage&&new Promise(function(e,f){try{a.onMessage(c,b,d)}catch(g){}})}var y=-1,p={},m={},n={},v={getResourcePath:function(){try{var a=this.id.split(".");return this._root+"/"+a[0]+"/resources/"}catch(c){return""}},removeEvents:function(){var a=this.events,c=null;if("array"==U.type(a)){if(0==
arguments.length)c=this.events;else for(var c=[],b=arguments.length;b--;){var d=arguments[b];"string"==typeof d&&a[d]&&c.push(d)}for(b=c.length;b--;)a=c[b],p[a]&&(a=p[a],d=a.indexOf(this.id),-1<d&&a.splice(d,1))}},removeFromLoader:function(){if(scope.events&&m[scope.id])for(var a=CH.cache("PH.loader"),c=scope.events.length;c--;){var b=scope.events[c];a[b]&&(b=a[b],b[scope.id]&&delete b[scope.id])}},remove:function(){var a={plugin:this},c=this;PH.fire("plugin-remove-before",a,function(){(new Promise(function(b,
d){PH.fire("plugin-remove-in-process",a);CH.cache("PH.roots")[c.id]&&delete CH.cache("PH.roots")[c.id];n[c.id]&&delete n[c.id];scop.removeFromLoader();c.removeEvents();delete m[c.id];b()}))["finally"](function(){PH.fire("plugin-remove-after",a)})})},call:function(a,c){if("function"==typeof this[a])this[a](c)}};return{init:function(){if(0<arguments.length){var a=function(c,d,e,f){if("string"==U.type(b[c])){var g=b[c];CRUD.loadJSON(g+"loader.json",function(h){for(var k in h)if("undefined"==typeof d[k]){d[k]=
h[k];var l=h[k],m;for(m in l)e[m]=g}else{var l=h[k],n=d[k];for(m in l)e[m]=g,n[m]=l[m]}c++;c<b.length?a(c,d,e,f):(CH.cache("PH.loader",d),CH.cache("PH.roots",e),f(d))})}},c=function(a){for(var b in a)"init-ph-after"!=b&&g(b,"eager",null,!0);PH.fire("init-ph-after")},b=arguments;U.un(CH.cache("PH.configurations"))&&CH.cache("PH.configurations",{});U.un(CH.cache("PH.resources"))&&CH.cache("PH.resources",{});var d=CH.cache("PH.loader"),e=CH.cache("PH.roots");U.un(d)||U.un(e)?a(0,{},{all:b},c):c(d)}},
stop:function(){CH.clear("PH.configurations");CH.clear("PH.resources");CH.clear("PH.loader");CH.clear("PH.roots");p={};m={};n={}},reset:function(){var a=CH.cache("PH.roots");a.all&&(PH.stop(),PH.init.apply(this,a.all))},add:function(a,c){u(a);var b=!1;"undefined"==typeof a.id&&(a.id=++y,b=!0);m[a.id]=a;l(a);var d=!1;b||(d=t(a));b={plugin:a,params:c};if(d)PH.fire("plugin-add-after",b);else if(d=a.events,U.un(d)||"array"==U.type(d)&&0==d.length)PH.fire("plugin-add-after",b,function(){w(a,c,null,function(){a.removeFromLoader()})});
else{for(var e=d.length;e--;){var f=d[e];"string"==typeof f&&"undefined"==typeof p[f]&&(p[f]=[]);p[f].push(a.id)}PH.fire("plugin-add-after",b)}},fire:function(a,c,b){g(a,"lazy",function(){if(p[a])for(var d=p[a],e=d.length;e--;){var f=PH.getPluginById(d[e]);w(f,c,a,b)}else b&&(c.params&&(c=c.params),b(c))})},getPluginById:function(a){return m[a]?m[a]:null},sendMessage:function(a,c,b,d){new Promise(function(e,f){if(U.un(b)){var g=null,h;for(h in m)g=m[h],x(g,a,c,d)}else for(h=b.length;h--;)g=PH.getPluginById(b[h]),
x(g,a,c,d);e()})},addDecorator:function(a,c){v[a]=c},removeDecorator:function(a){delete v[a]}}}(),CRUD={loadJSON:function(e,g,f){CRUD.load(e,g,!0,f)},load:function(e,g,f,h,k){var l;if("undefined"!==typeof XMLHttpRequest)l=new XMLHttpRequest;else for(var t=["MSXML2.XmlHttp.5.0","MSXML2.XmlHttp.4.0","MSXML2.XmlHttp.3.0","MSXML2.XmlHttp.2.0","Microsoft.XmlHttp"],u=t.length;u--;)try{l=new ActiveXObject(t[u]);break}catch(w){}l.onreadystatechange=function(){if(!(4>l.readyState)&&200===l.status&&4===l.readyState)if(U.un(f))g(l.responseText);
else try{g(JSON.parse(l.responseText))}catch(e){g({})}};U.un(h)&&(h="GET");l.open(h,e,!0);if(U.un(k))l.send();else{e="";for(key in k)e+=encodeURIComponent(key)+"="+encodeURIComponent(k[key])+"&";l.send(e)}}};
